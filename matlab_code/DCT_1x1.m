c = zeros(1,8);
for i=1:8
    c(i)=0.5*cos(pi/16*i);
end
C_o = [c(4) c(4) c(4) c(4)
       c(2) c(6) -c(6) -c(2)
       c(4) -c(4) -c(4) c(4)
       c(6) -c(2) c(2) -c(6)];
   
C_e = [c(1) c(3) c(5) c(7)
       c(3) -c(7) -c(1) -c(5)
       c(5) -c(1) c(7) c(3)
       c(7) -c(5) c(3) -c(1)];
   
S = [182 196 199 201 203 201 199 173
     175 180 176 142 148 152 148 120
     148 118 123 115 114 107 108 107
     115 110 110 112 105 109 101 100
     104 106 106 102 104 95 98 105
     99 115 131 104 118 86 87 133
     112 154 154 107 140 97 88 151
     145 158 178 123 132 140 138 133];
 
dct_1d = zeros(8,8);
for i=1:8
    X_o = [S(1,i)+S(8,i) S(2,i)+S(7,i) S(3,i)+S(6,i) S(4,i)+S(5,i)].';
    X_e = [S(1,i)-S(8,i) S(2,i)-S(7,i) S(3,i)-S(6,i) S(4,i)-S(5,i)].';
    F1 = C_o*X_o;
    F2 = C_e*X_e;
    dct_1d(1:2:7,i)=F1;
    dct_1d(2:2:8,i)=F2;
end
 
S2 = dct_1d.';
dct_2d = zeros(8,8);
for i=1:8
    X_o = [S2(1,i)+S2(8,i) S2(2,i)+S2(7,i) S2(3,i)+S2(6,i) S2(4,i)+S2(5,i)].';
    X_e = [S2(1,i)-S2(8,i) S2(2,i)-S2(7,i) S2(3,i)-S2(6,i) S2(4,i)-S2(5,i)].';
    F1 = C_o*X_o;
    F2 = C_e*X_e;
    dct_2d(1:2:7,i)=F1;
    dct_2d(2:2:8,i)=F2;
end
S3=dct_2d.';